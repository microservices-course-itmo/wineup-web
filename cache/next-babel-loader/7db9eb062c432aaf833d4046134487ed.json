{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { animateScroll } from 'react-scroll';\nimport { useRouter } from 'next/router';\nimport { useRecoilValueLoadable, useRecoilState, useRecoilValue } from 'recoil';\nimport ButtonGroup from '../ButtonGroup';\nimport WineCard from '../WineCard';\nimport Loader from '../Loader';\nimport ChangePageButtons from '../ChangePageButtons';\nimport { parseImageSrc, getWineInfo, sortingButtons } from './utils';\nimport { winesSortState, winesState, sortedWinesState, winesQuery, winesPageState } from './store';\n\nconst Catalog = () => {\n  const [wines, setWines] = useRecoilState(winesState);\n  const sortedWine = useRecoilValue(sortedWinesState);\n  const [winesSort, setWinesSort] = useRecoilState(winesSortState);\n  const [winesPage, setWinesPage] = useRecoilState(winesPageState);\n  const {\n    contents,\n    state\n  } = useRecoilValueLoadable(winesQuery);\n  const router = useRouter();\n  useEffect(() => {\n    if (state === 'hasValue') {\n      setWines(contents);\n    }\n  }, [contents, setWines, state]);\n  useEffect(() => {\n    if (router.query.page) {\n      setWinesPage({\n        from: Number(router.query.page),\n        to: winesPage.to\n      });\n    } else {\n      setWinesPage({\n        from: 1,\n        to: winesPage.to\n      });\n    }\n  }, [router, setWinesPage, winesPage.to]);\n\n  const changePage = isNextPage => {\n    animateScroll.scrollToTop({\n      duration: 100\n    });\n\n    if (!isNextPage && winesPage.from > 1) {\n      router.push({\n        pathname: '/',\n        query: {\n          page: winesPage.from - 1\n        }\n      });\n    }\n\n    if (isNextPage) {\n      router.push({\n        pathname: '/',\n        query: {\n          page: winesPage.from + 1\n        }\n      });\n    }\n  };\n\n  return __jsx(\"div\", {\n    className: \"jsx-551144433\" + \" \" + 'catalog'\n  }, __jsx(ButtonGroup, {\n    title: \"\\u0421\\u043E\\u0440\\u0442\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C \\u043F\\u043E\",\n    activeButton: winesSort,\n    buttons: sortingButtons,\n    onChange: event => setWinesSort(event.currentTarget.value)\n  }), state === 'hasValue' && (wines.length > 0 ? __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"jsx-551144433\" + \" \" + 'grid'\n  }, sortedWine.map((wine, index) => __jsx(WineCard, {\n    key: wine.wine_position_id,\n    wineId: wine.wine_position_id,\n    imageSrc: parseImageSrc(wine.image),\n    info: getWineInfo(wine),\n    isLiked: Math.round(Math.random()),\n    color: index % 3\n  }))), __jsx(ChangePageButtons, {\n    isPrev: winesPage.from !== 1,\n    previousPage: () => changePage(),\n    nextPage: () => changePage(1)\n  })) : __jsx(\"p\", {\n    className: \"jsx-551144433\"\n  }, \"\\u041A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433 \\u043F\\u0443\\u0441\\u0442\")), state !== 'hasValue' && __jsx(\"div\", {\n    className: \"jsx-551144433\" + \" \" + 'message'\n  }, state === 'hasError' && __jsx(\"div\", {\n    className: \"jsx-551144433\" + \" \" + 'loading'\n  }, __jsx(\"img\", {\n    src: \"assets/error.svg\",\n    alt: \"error icon\",\n    className: \"jsx-551144433\" + \" \" + 'error-icon'\n  }), __jsx(\"p\", {\n    className: \"jsx-551144433\"\n  }, \"\\u041F\\u0440\\u043E\\u0438\\u0437\\u043E\\u0448\\u043B\\u0430 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430\", __jsx(\"br\", {\n    className: \"jsx-551144433\"\n  }), \"\\u041F\\u043E\\u043F\\u0440\\u043E\\u0431\\u0443\\u0439\\u0442\\u0435 \\u043F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443\")), state === 'loading' && __jsx(\"div\", {\n    className: \"jsx-551144433\" + \" \" + 'loading'\n  }, __jsx(Loader, null), __jsx(\"p\", {\n    className: \"jsx-551144433\"\n  }, \"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0436\\u0430\\u0435\\u043C \\u043A\\u0430\\u0442\\u0430\\u043B\\u043E\\u0433...\"))), __jsx(_JSXStyle, {\n    id: \"551144433\"\n  }, [\".catalog.jsx-551144433{width:100%;margin-left:35px;}\", \".grid.jsx-551144433{margin-bottom:30px;display:grid;grid-template-columns:repeat(auto-fit,300px);-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;gap:45px;}\", \".message.jsx-551144433{padding-top:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}\", \".loading.jsx-551144433{max-width:250px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;text-align:center;}\", \".loading.jsx-551144433 p.jsx-551144433{margin-top:25px;font-family:Playfair Display,serif;font-size:16px;color:#000000;}\", \".error-icon.jsx-551144433{width:120px;height:auto;}\", \"@media all and (max-width:767px){.catalog.jsx-551144433{margin-top:40px;margin-left:0;}}\"]));\n};\n\nexport * from './store';\nexport default Catalog;","map":null,"metadata":{},"sourceType":"module"}