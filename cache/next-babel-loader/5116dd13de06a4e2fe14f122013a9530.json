{"ast":null,"code":"import _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport { useRecoilCallback, useRecoilValue } from 'recoil';\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport ReactCountryFlag from 'react-country-flag';\nimport { addWineQuery, deleteWineQuery } from '../Favorites/favoritesStore';\nimport useLocalStorage from '../../utils/useLocalStorage';\nimport { userState } from '../../store/GlobalRecoilWrapper/store'; // Форматирует цены\n\nconst {\n  format: formatPrice\n} = new Intl.NumberFormat('ru-RU', {\n  style: 'currency',\n  currency: 'RUB',\n  minimumFractionDigits: 0,\n  maximumFractionDigits: 2\n}); // Форматирует числа\n\nconst {\n  format: formatNumber\n} = new Intl.NumberFormat('ru-RU'); // Цвета для заднего фона\n\nconst colors = ['#931332', '#BBADA4', '#FAA4A4']; // Количество звездочек (для циакла)\n\nconst starsNumber = [1, 2, 3, 4, 5];\n/**\n * Карточка вина с главной информацией о нём\n * @param {string} imageSrc - Адрес изображения бутылки вина\n * @param {boolean} isLiked - Флаг, показывающий лайкнул ли юзер винчик\n * @param {number} color - Номер цвета заднего фона, всего их три, они указаны в массиве colors\n * @param {Object} info - Информация о вине\n * @param {string} wineId - id винной позиции\n * @param {string} info.shop - Название магазина\n * @param {string} info.name - Название вина\n * @param {string} info.about - Тип и цвет винчика\n * @param {Object} info.country - Страна изготовитель\n * @param {string} info.country.code - Код страны (например, fr для Франции)\n * @param {string} info.country.name - Название страны на руссоком\n * @param {number} info.size - Размер бутылки\n * @param {number} info.year - Год\n * @param {number} info.fitsPercent - Процент насколько подходит юзеру вино\n * @param {number} info.stars - Сколько эксперты дали звёзд\n * @param {number} info.price - Цена без скидок\n * @param {Object} info.discount - Опциональный параметр, указывает, что на вино есть скидка\n * @param {number} info.discount.price - Цена со скидкой\n * @param {number} info.discount.percent - Сколько процентов скидка\n */\n\nconst WineCard = ({\n  imageSrc,\n  info,\n  isLiked,\n  color,\n  wineId\n}) => {\n  const userExist = useRecoilValue(userState);\n  const [accessToken] = useLocalStorage('accessToken');\n  const {\n    0: isHeartFilled,\n    1: setIsHeartFilled\n  } = useState(isLiked);\n  const addFavorite = useRecoilCallback(({\n    snapshot,\n    id\n  }) => async () => {\n    await snapshot.getPromise(addWineQuery(id, accessToken));\n  });\n  const deleteFavorite = useRecoilCallback(({\n    snapshot,\n    id\n  }) => async () => {\n    await snapshot.getPromise(deleteWineQuery(id, accessToken));\n  });\n\n  const clickHeart = id => {\n    if (userExist) {\n      if (!isHeartFilled) {\n        setIsHeartFilled(true);\n        addFavorite(id);\n      } else {\n        setIsHeartFilled(false);\n        deleteFavorite(id);\n      }\n    }\n  };\n\n  return __jsx(Link, {\n    href: `/wine/${wineId}`\n  }, __jsx(\"div\", {\n    className: \"card\"\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'top'\n  }, __jsx(\"button\", {\n    onClick: () => clickHeart(wineId),\n    type: \"button\",\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'heart-button'\n  }, __jsx(\"img\", {\n    src: `assets/card/heart-${isHeartFilled ? 'filled' : 'empty'}.svg`,\n    alt: \"heart\",\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + `heart ${isHeartFilled ? 'filled' : ''}`\n  })), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'score'\n  }, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'stars'\n  }, starsNumber.map((star, index) => __jsx(\"img\", {\n    src: `assets/card/${index < info.stars ? 'filled' : 'empty'}-star.svg`,\n    alt: `${index < info.stars ? 'filled' : 'empty'} star`,\n    key: star.toString(),\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }))), imageSrc ? __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'img-container'\n  }, __jsx(\"img\", {\n    src: imageSrc,\n    alt: info.name,\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'wine-img'\n  })) : null, __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'wine-bg'\n  }, __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'price'\n  }, formatPrice(info.discount ? info.discount.price : info.price)), __jsx(\"h4\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'size'\n  }, formatNumber(info.size), \" \\u043B.\")), info.discount ? __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'discount'\n  }, __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'discount-percent'\n  }, \"-\", info.discount.percent, \"%\"), __jsx(\"h4\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'old-price'\n  }, formatPrice(info.price))) : null), __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'name'\n  }, info.name), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'line'\n  }), __jsx(\"h2\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'year'\n  }, info.year, \" \\u0433.\"), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'icons'\n  }, __jsx(ReactCountryFlag, {\n    style: {\n      width: 20,\n      height: 15,\n      borderRadius: 3\n    },\n    countryCode: info.country.code,\n    svg: true\n  }), __jsx(\"img\", {\n    src: \"/assets/card/bottle-icon.svg\",\n    alt: \"bottle icon\",\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }), __jsx(\"img\", {\n    src: \"/assets/card/fits-icon.svg\",\n    alt: \"fits icon\",\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }), __jsx(\"img\", {\n    src: \"/assets/card/shop-icon.svg\",\n    alt: \"shop icon\",\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  })), __jsx(\"div\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]]) + \" \" + 'info'\n  }, __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }, info.country.name), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }, info.about), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }, \"\\u041F\\u043E\\u0434\\u0445\\u043E\\u0434\\u0438\\u0442 \\u0432\\u0430\\u043C \\u043D\\u0430 \", info.fitsPercent, \"%\"), __jsx(\"p\", {\n    className: _JSXStyle.dynamic([[\"2908051031\", [colors[color] || '#931332']]])\n  }, info.shop)), __jsx(_JSXStyle, {\n    id: \"2908051031\",\n    dynamic: [colors[color] || '#931332']\n  }, [\".flag-icon.__jsx-style-dynamic-selector{background-size:contain;background-position:50%;background-repeat:no-repeat;}\", \".card.__jsx-style-dynamic-selector{width:300px;height:587px;position:relative;background-color:#ffffff;cursor:pointer;}\", \".top.__jsx-style-dynamic-selector{height:340px;position:relative;}\", \".heart-button.__jsx-style-dynamic-selector{padding:10px;border:none;background-color:#ffffff;outline:none;cursor:pointer;}\", \".heart.__jsx-style-dynamic-selector{fill:transparent;stroke:#931332;-webkit-transition:fill 0.3s;transition:fill 0.3s;}\", \".heart.filled.__jsx-style-dynamic-selector{fill:#931332;}\", \".stars.__jsx-style-dynamic-selector{width:137px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;}\", \".score.__jsx-style-dynamic-selector{padding-left:10px;padding-top:52px;}\", \".score-caption.__jsx-style-dynamic-selector{padding-top:4px;font-family:PT Sans,sans-serif;font-style:normal;font-weight:normal;font-size:14px;line-height:18px;color:#9e9e9e;}\", \".wine-img.__jsx-style-dynamic-selector{width:auto;height:270px;position:absolute;top:50px;right:65px;z-index:2;}\", `.wine-bg.__jsx-style-dynamic-selector{width:100%;height:122px;position:absolute;top:152px;background-color:${colors[color] || '#931332'};}`, \".discount.__jsx-style-dynamic-selector{position:absolute;top:60px;right:5px;}\", \".discount-percent.__jsx-style-dynamic-selector{font-family:Playfair Display,serif;font-style:normal;font-weight:900;font-size:30px;line-height:40px;color:#931332;}\", \".old-price.__jsx-style-dynamic-selector{position:relative;font-family:Playfair Display,serif;font-style:normal;font-weight:bold;font-size:20px;line-height:27px;-webkit-text-decoration-line:line-through;text-decoration-line:line-through;color:#c4c4c4;}\", \".price.__jsx-style-dynamic-selector{position:absolute;top:40px;left:20px;font-family:Playfair Display,serif;font-style:normal;font-weight:bold;font-size:28px;line-height:37px;color:#ffffff;}\", \".size.__jsx-style-dynamic-selector{position:absolute;bottom:5px;right:5px;font-family:Playfair Display,serif;font-style:normal;font-weight:bold;font-size:18px;line-height:24px;color:#ffffff;}\", \".name.__jsx-style-dynamic-selector{max-height:75px;padding-left:10px;font-family:Playfair Display,serif;font-style:normal;font-weight:bold;font-size:28px;line-height:37px;color:#000000;overflow:hidden;}\", \".line.__jsx-style-dynamic-selector{width:165px;position:absolute;bottom:155px;left:10px;border-bottom:2px solid #9e9e9e;}\", \".year.__jsx-style-dynamic-selector{position:absolute;bottom:5px;right:5px;font-family:Playfair Display,serif;font-style:normal;font-weight:bold;font-size:30px;line-height:40px;color:#000000;}\", \".icons.__jsx-style-dynamic-selector{width:25px;height:108px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;bottom:20px;left:10px;}\", \".info.__jsx-style-dynamic-selector{position:absolute;bottom:11px;left:45px;font-family:PT Sans,sans-serif;font-style:normal;font-weight:normal;font-size:18px;line-height:31px;color:#9e9e9e;}\"]))));\n};\n\nexport default WineCard;","map":null,"metadata":{},"sourceType":"module"}